<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Garantir que o Font Awesome seja carregado corretamente -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="stylesheet" href="./resources/ol.css">
    <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
    <link rel="stylesheet" href="./resources/qgis2web.css">
    <link rel="stylesheet" href="./styles/css/index.css">

    <title>SIG 2024 ~ Gloria</title>
</head>

<body>
    <header>
        <h3>Análise Espacial da ODS 11: Mapas de Desenvolvimento Sustentável (Curitiba-PR)</h3>
        <h4>Disciplina: Sistema de Informações Geográficas (SIG) 2024</h4>
    </header>

    <div id="map">
        <div id="popup" class="ol-popup">
            <a href="#" id="popup-closer" class="ol-popup-closer"></a>
            <div id="popup-content"></div>
        </div>
    </div>

    <!-- Imagem 1: UFPR -->
    <button class="img img1">
        <img src="./styles/logos/ufpr.png" alt="Pessoa" style="height: 35px;">
    </button>

    <!-- Imagem 2: Setor de Ciencias da Terra -->
    <button class="img img2">
        <img src="./styles/logos/ct.png" alt="Pessoa" style="height: 35px;">
    </button>

    <!-- Imagem 3: Departamento de Geomática -->
    <button class="img img3">
        <img src="./styles/logos/geomatica.png" alt="Pessoa" style="height: 35px;">
    </button>

    <!-- Imagem 4: Engenharia Cartográfica e de Agrimensura -->
    <button class="img img4">
        <img src="./styles/logos/carto2.png" alt="Pessoa" style="height: 35px;">
    </button>

    <!-- Ícone de Pessoa -->
    <button id="person-toggle"><i class="fas fa-user"></i></button>

    <!-- Ícone de Info -->
    <button id="info-toggle"><i class="fas fa-info-circle"></i></button>

    <!-- Ícone de Pessoa -->
    <button class="icon-button person-toggle"><i class="fas fa-user"></i></button>

    <!-- Ícone de Info -->
    <button class="icon-button info-toggle"><i class="fas fa-info-circle"></i></button>

    <!-- Ícone de Documento -->
    <button class="icon-button document-toggle"><i class="fas fa-file-alt"></i></button>

    <!-- Ícone de Número 1 -->
    <button class="icon-button number-toggle-1" id="toggle-all-layers-map1" data-container="map1">
        <i class="fas fa-map" style="margin-right: 5px;"></i>
        <i class="fas fa-1"></i>
    </button>

    <!-- Ícone de Número 2 -->
    <button class="icon-button number-toggle-2" id="toggle-all-layers-map2" data-container="map2">
        <i class="fas fa-map" style="margin-right: 5px;"></i>
        <i class="fas fa-2"></i>
    </button>

    <!-- Ícone de Número 3 -->
    <button class="icon-button number-toggle-3" class="layer-toggle" data-layer="10">
        <i class="fas fa-map" style="margin-right: 5px;"></i>
        <i class="fas fa-3"></i>
    </button>

    <!-- Ícone de camadas -->
    <button id="menu-toggle" class="icon-button menu-toggle"><i class="fas fa-layer-group"></i></button>

    <div id="feature-box" style="margin-top: 50px; display: none;"> <!-- Menu inicialmente fechado -->
        <h3>Camadas</h3>
        <hr>
        <div id="map1">
            <h4 style="padding-bottom: 5px;">Mapa 01<br> Bairros Saudáveis: Localização de Parques, Ciclovias e
                Transporte Público</h4>
            <label><input type="checkbox" class="layer-toggle" data-layer="6" checked> Terminal de ônibus</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="5" checked> Zonas de influência dos terminais
                de ônibus (Diagrama Voronoi)</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="4" checked> Ciclovia</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="3" checked> Parques e Bosques</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="2" checked> Praças e Jardinetes</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="1" checked> Bairros de Curitiba</label>
            <button id="toggle-all-layers-map1" data-container="map1">Ativar/Desativar Todas as Camadas</button>
            <button id="view-pdf">
                <a href="./pdf/Mapa01-ODS11-BairrosSaudaveis-GloriaDeitos.pdf" target="_blank"
                    style="text-decoration: none; color: inherit;">
                    Visualizar PDF
                </a>
            </button>
            <button id="download-pdf">
                <a href="./pdf/Mapa01-ODS11-BairrosSaudaveis-GloriaDeitos.pdf" download
                    style="text-decoration: none; color: inherit;">
                    Baixar PDF
                </a>
            </button>
        </div>
        <hr>
        <div id="map2">
            <h4 style="padding-bottom: 5px;">Mapa 02<br> Mapa de Risco: Áreas de Ocupação Irregular com Potencial de
                Alagamento</h4>
            <label><input type="checkbox" class="layer-toggle" data-layer="9"> Áreas inundáveis</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="7"> Áreas de Ocupação Irregular</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="8"> Rios</label>
            <label><input type="checkbox" class="layer-toggle" data-layer="1" checked> Bairros de Curitiba</label>
            <button id="toggle-all-layers-map2" data-container="map2">Ativar/Desativar Todas as Camadas</button>
            <button id="view-pdf">
                <a href="./pdf/Mapa02-ODS11-MapaRisco-GloriaDeitos.pdf" target="_blank"
                    style="text-decoration: none; color: inherit;">
                    Visualizar PDF
                </a>
            </button>
            <button id="download-pdf">
                <a href="./pdf/Mapa02-ODS11-MapaRisco-GloriaDeitos.pdf" download
                    style="text-decoration: none; color: inherit;">
                    Baixar PDF
                </a>
            </button>
        </div>
        <hr>
        <h4 style="padding-bottom: 5px;">Mapa 03<br> Cobertura Verde: Percentual de Parques e Bosques nos Bairros de
            Curitiba</h4>
        <label><input type="checkbox" class="layer-toggle" data-layer="10"> Porcentagem de parques e bosques</label>
        <button id="view-pdf">
            <a href="./pdf/Mapa03-ODS11-CoberturaVerde-GloriaDeitos.pdf" target="_blank"
                style="text-decoration: none; color: inherit;">
                Visualizar PDF
            </a>
        </button>
        <button id="download-pdf">
            <a href="./pdf/Mapa03-ODS11-CoberturaVerde-GloriaDeitos.pdf" download
                style="text-decoration: none; color: inherit;">
                Baixar PDF
            </a>
        </button>
    </div>

    <div id="legend-container">
        <!-- Legenda Mapa 01 -->
        <div id="legend-map1" style="display: none;">
            <h4>Mapa 01</h4>
            <h5>Bairros Saudáveis: Localização de Parques, Ciclovias e Transporte Público</h5>
            <hr>
            <h4>Legenda</h4>
            <ul style="list-style: none; padding: 0; font-size: 14px; color: #333;">
                <li>
                    <img src="./styles/legend/terminal.png" alt="Terminal de ônibus" class="legenda">
                    Terminal de ônibus
                </li>
                <li>
                    <img src="./styles/legend/zona-influencia.png" alt="Zonas de influência dos terminais de ônibus"
                        class="legenda">
                    Zonas de influência dos terminais de ônibus
                </li>
                <li>
                    <img src="./styles/legend/ciclovia.png" alt="Ciclovia" class="legenda">
                    Ciclovia
                </li>
                <li>
                    <img src="./styles/legend/parque-bosque.png" alt="Parques e Bosques" class="legenda">
                    Parques e bosques
                </li>
                <li>
                    <img src="./styles/legend/praca-jardinete.png" alt="Praças e Jardinetes" class="legenda">
                    Praças e jardinetes
                </li>
                <li>
                    <img src="./styles/legend/divisa-bairro.png" alt="Praças e Jardinetes" class="legenda">
                    Divisa de bairros
                </li>
            </ul>
        </div>

        <!-- Legenda Mapa 02 -->
        <div id="legend-map2" style="display: none;">
            <h4>Mapa 02</h4>
            <h5>Mapa de Risco: Áreas de Ocupação Irregular com Potencial de Alagamento</h5>
            <hr>
            <h4>Legenda</h4>
            <ul style="list-style: none; padding: 0; font-size: 14px; color: #333;">
                <li>
                    <img src="./styles/legend/ocupacao-irregular.png" alt="Áreas de Ocupação Irregular" class="legenda">
                    Áreas de Ocupação Irregular
                </li>
                <li>
                    <img src="./styles/legend/areas-inundaveis.png" alt="Áreas Inundáveis" class="legenda">
                    Áreas Inundáveis
                </li>
                <li>
                    <img src="./styles/legend/rio.png" alt="Rios" class="legenda">
                    Rios
                </li>
                <li>
                    <img src="./styles/legend/divisa-bairro.png" alt="Praças e Jardinetes" class="legenda">
                    Divisa de bairros
                </li>
            </ul>
        </div>

        <!-- Legenda Mapa 03 -->
        <div id="legend-map3" style="display: none;">
            <h4>Mapa 03</h4>
            <h5>Cobertura Verde: Percentual de Parques e Bosques nos Bairros de Curitiba</h5>
            <hr>
            <h4>Legenda</h4>
            <h5>Porcentagem de parques e bosques por área total do bairro</h5>
            <ul style="list-style: none; padding: 0; font-size: 14px; color: #333;">
                <img src="./styles/legend/1.png" class="legenda" /> 0 - 0.3<br />
                <img src="./styles/legend/2.png" class="legenda" /> 0.4 - 1.62<br />
                <img src="./styles/legend/3.png" class="legenda" /> 1.63 - 4.51<br />
                <img src="./styles/legend/4.png" class="legenda" /> 4.52 - 7.22<br />
                <img src="./styles/legend/5.png" class="legenda" /> 7.23 - 10.13<br />
            </ul>
        </div>
        <!-- Legenda Bairros de Curitiba (usado em ambos os mapas) -->
        <div id="legend-bairros" style="display: none;">
            <h4>Bairros de Curitiba</h4>
            <ul style="list-style: none; padding: 0; font-size: 14px; color: #333;">
                <li>
                    <img src="./styles/legend/divisa-bairro.png" alt="Divisa de Bairros" class="legenda">
                    Divisa de Bairros
                </li>
            </ul>
        </div>
    </div>

    <footer>
        <p>&copy; 2024 Glória Maria Deitos Gomes da Silva.</p>
    </footer>

    <script src="resources/qgis2web_expressions.js"></script>
    <script src="./resources/functions.js"></script>
    <script src="./resources/ol.js"></script>
    <script src="./resources/ol-layerswitcher.js"></script>

    <!-- MAPA01 -->
    <script src="layers/DIVISA_DE_BAIRROS_1.js"></script> <!-- Camada 1: Bairros de Curitiba -->
    <script src="layers/PRACAS_E_JARDINETES_2.js"></script> <!-- Camada 2: Praças e Jardinetes -->
    <script src="layers/PARQUES_E_BOSQUES_3.js"></script> <!-- Camada 3: Parques e Bosques -->
    <script src="layers/CICLOVIA_OFICIAL_4.js"></script> <!-- Camada 4: Ciclovia -->
    <script src="layers/terminalvoronoi_5.js"></script>
    <!-- Camada 5: Zonas de influência dos terminais de ônibus (Diagrama Voronoi) -->
    <script src="layers/TERMINAL_DE_TRANSPORTE_6.js"></script> <!-- Camada 6: Terminal de ônibus -->

    <script src="styles/DIVISA_DE_BAIRROS_1_style.js"></script> <!-- Estilo para a Camada 1 -->
    <script src="styles/PRACAS_E_JARDINETES_2_style.js"></script> <!-- Estilo para a Camada 2 -->
    <script src="styles/PARQUES_E_BOSQUES_3_style.js"></script> <!-- Estilo para a Camada 3 -->
    <script src="styles/CICLOVIA_OFICIAL_4_style.js"></script> <!-- Estilo para a Camada 4 -->
    <script src="styles/terminalvoronoi_5_style.js"></script> <!-- Estilo para a Camada 5 -->
    <script src="styles/TERMINAL_DE_TRANSPORTE_6_style.js"></script> <!-- Estilo para a Camada 6 -->

    <!-- MAPA02 -->
    <script src="layers/OCUPACAO_IRREGULAR_2.js"></script>
    <!-- Camada 7: Áreas de Ocupação Irregular com Potencial de Alagamento -->
    <script src="layers/HIDRO_RIOS_LN_3.js"></script> <!-- Camada 8: Rios -->
    <script src="layers/Interseo_4.js"></script> <!-- Camada 9: Interseções (possível área de estudo) -->

    <script src="styles/OCUPACAO_IRREGULAR_2_style.js"></script> <!-- Estilo para a Camada 7 -->
    <script src="styles/HIDRO_RIOS_LN_3_style.js"></script> <!-- Estilo para a Camada 8 -->
    <script src="styles/Interseo_4_style.js"></script> <!-- Estilo para a Camada 9 -->

    <!-- MAPA03 -->
    <script src="layers/PARQUEPORCENTAGEM_2.js"></script> <!-- Camada 10: Porcentagem parques e bosques -->
    <script src="styles/PARQUEPORCENTAGEM_2_style.js"></script> <!-- Estilo para a Camada 10 -->

    <!-- Precisa estar no final: -->
    <script src="./layers/layers.js" type="text/javascript"></script>
    <script src="./resources/Autolinker.min.js"></script>
    <script src="./resources/qgis2web.js"></script>

    <script>
        document.querySelector('.number-toggle-3').addEventListener('click', function () {
            // Recuperar o checkbox associado à camada de "Porcentagem de parques e bosques" (Camada 10)
            const checkbox = document.querySelector('input[data-layer="10"]');

            // Alternar o estado do checkbox
            checkbox.checked = !checkbox.checked;

            // Atualizar a visibilidade da camada com base no estado do checkbox
            const layer = map.getLayers().item(10); // Camada 10 corresponde ao índice 9 (contagem começa do 0)
            layer.setVisible(checkbox.checked);
        });

        // Configurar os toggles de camadas para cada mapa separadamente
        document.querySelectorAll('.layer-toggle').forEach(toggle => {
            // Inicializa a visibilidade das camadas com base no estado do checkbox
            const layerIndex = parseInt(toggle.dataset.layer, 10);
            const layer = map.getLayers().item(layerIndex);
            layer.setVisible(toggle.checked);

            // Adiciona o evento para cada checkbox
            toggle.addEventListener('change', function () {
                const layerIndex = parseInt(this.dataset.layer, 10);
                map.getLayers().item(layerIndex).setVisible(this.checked);
                updateLegends(); // Atualizar as legendas após a mudança
            });
        });

        // Função para ativar/desativar todas as camadas de um mapa específico
        function toggleLayersForMap(containerId) {
            const container = document.getElementById(containerId);
            const toggles = container.querySelectorAll('.layer-toggle');
            const allChecked = Array.from(toggles).every(toggle => toggle.checked);

            toggles.forEach(toggle => {
                toggle.checked = !allChecked;
                const layerIndex = parseInt(toggle.dataset.layer, 10);
                map.getLayers().item(layerIndex).setVisible(!allChecked);
            });

            updateLegends(); // Atualizar as legendas após a alteração
        }

        // Configurar os botões de ativar/desativar todas as camadas de forma independente
        document.querySelectorAll('button[id^="toggle-all-layers"]').forEach(button => {
            button.addEventListener('click', function () {
                const containerId = this.dataset.container;
                toggleLayersForMap(containerId);
            });
        });

        // Função para exibir/ocultar o menu de camadas
        const menuToggle = document.getElementById('menu-toggle');
        const featureBox = document.getElementById('feature-box');

        menuToggle.addEventListener('click', () => {
            if (featureBox.style.display === 'none') {
                featureBox.style.display = 'block';
                menuToggle.innerHTML = '<i class="fas fa-times"></i>'; // Ícone de fechar
            } else {
                featureBox.style.display = 'none';
                menuToggle.innerHTML = '<i class="fas fa-layer-group"></i>'; // Ícone de camadas
            }
        });

        // Inicialmente, o menu está fechado
        featureBox.style.display = 'none';


        // == LEGENDAS

        function updateLegends() {
            // Esconde todas as legendas inicialmente
            document.querySelectorAll('#legend-container > div').forEach(legend => {
                legend.style.display = 'none';
            });

            // Obtém o estado das camadas
            const layersVisibility = [];
            map.getLayers().forEach((layer, index) => {
                layersVisibility[index] = layer.getVisible();
            });

            // Regras para exibição das legendas
            const isLayer1Active = layersVisibility[1]; // Bairros de Curitiba
            const isLayer2To6Active = layersVisibility.slice(2, 7).some(visible => visible); // Camadas 2 a 6
            const isLayer7To9Active = layersVisibility.slice(7, 10).some(visible => visible); // Camadas 7 a 9
            const isLayer10Active = layersVisibility[10]; // Porcentagem de parques e bosques

            // Determina qual legenda mostrar com base nas condições
            if (isLayer2To6Active) {
                document.getElementById('legend-map1').style.display = 'block'; // Legenda 1
            }
            if (isLayer7To9Active) {
                document.getElementById('legend-map2').style.display = 'block'; // Legenda 2
            }
            if (isLayer1Active && !isLayer2To6Active && !isLayer7To9Active && !isLayer10Active) {
                document.getElementById('legend-map4').style.display = 'block'; // Legenda 4
            }
            if (isLayer10Active) {
                document.getElementById('legend-map3').style.display = 'block'; // Legenda 3
            }
        }

        // Atualiza as legendas quando a página é carregada e ao interagir com os checkboxes
        document.querySelectorAll('.layer-toggle').forEach(input => {
            input.addEventListener('change', () => {
                const layerIndex = parseInt(input.getAttribute('data-layer'));
                const layer = map.getLayers().item(layerIndex);
                layer.setVisible(input.checked);
                updateLegends();
            });
        });

        // Inicializa as legendas corretamente ao carregar a página
        window.addEventListener('DOMContentLoaded', () => {
            updateLegends();
        });

    </script>

</body>

</html>